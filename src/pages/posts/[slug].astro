---
import { Image } from 'astro:assets';
import BaseHead from '../../components/Head/BaseHead.astro';
import Nav from '../../components/Nav.astro';
import HomeHeader from '../../components/HomeHeader.astro';
import Footer from '../../components/Footer/Footer.astro';
import { marked } from 'marked';
import Comments from '../../components/Comments.astro';
import { getAllPosts } from '../../lib/cosmic.js';

export async function getStaticPaths() {
  const data = (await getAllPosts()) || [];

  return data.map((post) => {
    return {
      params: { slug: post.slug },
      props: { post },
    };
  });
}

const { post } = Astro.props;
console.log("Post: ", post);
let pageTitle = post.title;
let pageDescription = post.metadata.excerpt;
let seoTitle = '3rd Coast Nibbles & Sipps - ' + post.title;
let seoDescription = post.slug;
let content = marked.parse(post.metadata.content);

---
<html lang="en">

<head>
  <BaseHead title={seoTitle} description={seoDescription} />
</head>

<body class="bg-white text-black font-body leading-normal personality-casual">
  <Nav />

  <main class="py-12 lg:py-20">
    <article class="max-w-6xl mx-auto px-3">
      <HomeHeader title={pageTitle} description={pageDescription} />
      <article class="border-b pb-8">
        <!-- <h1 class="text-4xl font-bold">{post.title}</h1> -->
        
      <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6 py-8" data-test="articles-section">
        <div class="my-8 float-left" set:html={content}>
        </div>
        <div class="my-8 float-right">
          <Image 
            src={post.metadata.cover_image.url} 
            alt="" 	
            width="300"
            height="300"
            class="rounded-lg shadow-lg float-right"
        />
        </div>
      </section>
    </article>
  </main>
  <Comments />
  <Footer />
</body>

</html>